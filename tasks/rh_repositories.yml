# Copyright 2017 Red Hat, Inc. and/or its affiliates
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# Play for add clients and interconnect repos on RHEL 7.
---
- name: Add interconnect repo on rhel7 VM.
  command: subscription-manager repos --enable=amq-interconnect-1-for-rhel-7-server-rpms
  when: ansible_distribution_major_version > '6'

- name: Add client repo on rhel7 VM..
  command: subscription-manager repos --enable=a-mq-clients-1-for-rhel-7-server-beta-rpms
  when: ansible_distribution_major_version > '6'

- name: Add interconnect repo on rhel6 VM.
  command: subscription-manager repos --enable=amq-interconnect-1-for-rhel-6-server-rpms
  when: ansible_distribution_major_version < '7'

- name: Add client repo on rhel6 VM.
  command: subscription-manager repos --enable=a-mq-clients-1-for-rhel-6-server-beta-rpms
  when: ansible_distribution_major_version < '7'

- name: Install yum-utill.
  command: yum install -y yum-utils device-mapper-persistenvirt-data lvm2
  when: ansible_distribution == "RedHat" and ansible_distribution_major_version > '6'

# - name: Add epel repos on rhel7 VM.
#   command: yum-config-manager --add-repo=https://dl.fedoraproject.org/pub/epel/7/x86_64/
#   when: ansible_distribution == "RedHat" and ansible_distribution_major_version > '6'
#
# - name: Download EPEL GPG key.
#   command: wget -O /etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7 https://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7
#   when: ansible_distribution == "RedHat" and ansible_distribution_major_version > '6'
#
# - name: Import GPG key.
#   command: rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7
#   when: ansible_distribution == "RedHat" and ansible_distribution_major_version > '6'
#
# - name: Add epel repos on rhel6 VM.
#   command: rpm -ivh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm --force
#   when: ansible_distribution == "RedHat" and ansible_distribution_major_version < '7'
